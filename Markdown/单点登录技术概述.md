# JD 无线组单点登录技术概述

根据[维基百科的解释][1]，单点登录（Single sign-on，SSO）的作用是：

> 用户只需要登录一次就可以访问所有相互信任的应用系统

打开你手机中安装的任意一款软件，比如购物软件，你可以查看个人信息、查看个人的购物记录或者选择商品并下单；比如微信，你同样可以查看自己的个人信息、查看朋友圈或者向好友发送消息；再比如你打开豆瓣，你发现你可以在豆瓣电影中搜索某部电影的评价、你可以在豆瓣读书下搜索某部图书的价格、你也可以在豆瓣中写日记。今天我们所使用的绝大部分软件都有各种不同的功能（特别是国内的软件），这其中的大部分功能只有在我们登陆后才能使用。

因为专业细分，同一款软件内不同的模块可能由不同的团队在维护与开发，从软件工程的角度来看，软件模块的切分与隔离也是非常合理的。不同的模块有些功能是重复的，比如对用户有效性的验证：你查询个人信息的时候因为隐私原因，你必须先登录；你向朋友发送消息时系统也要验证用户的有效性，否则拒绝发送信息，不登录你甚至连历史记录都看不见。如果用户每打开一个模块就需要重新登录一次，我想除了政府相关的软件，这款软件应该早就没人用了吧 :smile:。

解决这类问题一个常见的方法是，用户登录成功后在一个所有模块都能访问到的地方保存一份加密的用户登录凭证（ticket），其他服务使用这个凭证来验证用户信息。如果某个服务发现凭证无效，这个服务就会拉起登录页面，强制用户登录，并随后保存新的有效凭证供其他服务使用。

这里先大致描述一下 SSO 的工作流程：

1. 用户打开软件，查询自己的购物记录，购物模块需要验证用户的有效性
2. 购物模块没有发现能验证用户有效身份的数据，拉起登录界面让用户登录（登录过程由软件的登录模块完成）
3. 用户输入有效的用户名与密码（或者其他登录方式），登录模块发送加密的用户名和密码给 SSO 后台服务
4. SSO 解密用户数据并验证用户名和密码，如果验证通过则下发登录凭证给软件（软件的登录模块）
5. 其他模块在需要验证用户信息时会从登录模块获取凭证，随后将这个凭证发送给 SSO 进行验证，验证通过则提供服务，否则拒绝

从上面的讲述中可知，一个 SSO 系统有两个职责，一个是登录，一个是验证，其中最主要的功能是验证用户的登录凭证。

SSO 是典型的 IO 密集型服务（相对的是 CPU 密集型，即计算密集型）。为了提供高并发、低时延的服务，SSO 系统一般也是典型的分布式系统。

## SSO&Kerberos

[Kerberos][2] 是由 MIT 开发的可以在非安全网络环境下对用户进行安全认证的授权协议。SSO 所使用的几乎所有概念在这个协议中都有所体现，大部分 SSO 系统可以认为是对这个协议一个子集的实现。本文不对 Kerberos 做详细的介绍，下面有几个讲述 Kerberos 的博客可供参考：

1. [https://blog.csdn.net/wulantian/article/details/42418231][3]
2. [https://www.cnblogs.com/ulysses-you/p/8107862.html][4]































[1]:https://en.wikipedia.org/wiki/Single_sign-on
[2]:https://en.wikipedia.org/wiki/Kerberos_(protocol)
[3]:https://blog.csdn.net/wulantian/article/details/42418231
[4]:https://www.cnblogs.com/ulysses-you/p/8107862.html



































